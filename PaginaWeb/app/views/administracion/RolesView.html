{% extends "base.html" %}
{% block title %} Gestion de Roles {% endblock %}
{% block nav %}
{% include 'partials/nav.html' with {datos:datos} only %}
{% endblock %}
{% block main %}
{% if datos.newError %}
<script>
    alertify.alert(
        "<span class='fa fa-times-circle fa-2x' style='vertical-align:middle;color:#e10000'></span><span style='font-size:15px; color:black'> Error al crear nuevo Rol</span>",
        "El Rol ya existe..");
</script>
{% endif %}
{% if datos.okUpdate %}
<script>
    alertify.alert(
        "<span class='fa fa-check-circle fa-2x' style='vertical-align:middle;color:#00e104'></span><span style='font-size:15px; color:black'> Modificaciones realizadas</span>",
        "Permisos actualizados correctamente");
</script>
{% endif %}
<div>
    {% block header %}
    {% include 'partials/header.html' with {datos:datos} only %}
    {% endblock %}
    <h2 class="titulo-tabla">Roles Registrados </h2>
    <!-- Button to Open the Modal -->
    {% if "9" in datos.permisos %}
    <button type="button" class="btn btn-success btn-lg" data-toggle="modal" data-target="#nuevoModal"><i
            class="fa fa-plus"></i> Crear Nuevo</button>
    <!-- The Modal -->
    <div class="modal fade" id="nuevoModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Crear Rol</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <!-- Modal body -->
                <div class="modal-body">
                    <form action="newRol" method="post" class="was-validated">
                        <div class="form-group">
                            <label for="nombreRol">Nombre del Rol:</label>
                            <input type="text" name="nombreRol" class="form-control" autofocus required>
                            <div class="invalid-feedback">Complete este campo</div>
                        </div>
                        <!-- Modal footer -->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Salir</button>
                            <button type="submit" class="btn btn-success">Enviar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    <table id="miTabla" class="table table-bordered table-sm table-responsive-lg table-striped table-hover text-nowrap">
        <thead class="headtable">
            <tr>
                <th>NÂº Rol</th>
                <th>Nombre</th>
                <th>Accion</th>
            </tr>
        </thead>
        <tbody>
            {% for rol in datos.todosRoles %}
            <tr>
                <td>{{ rol.idRol }}</td>
                <td>{{ rol.nombreRol }}</td>
                <td>
                    <div class="btn-group" role="group" aria-label="Basic example" style="float: none;">
                        {% if "12" in datos.permisos %}
                        <button type="button" class="btn btn-outline-primary" data-toggle="modal"
                            onclick="fichaRoles('{{ rol.idRol }}',false);return false;" title="Ver Mas"><i
                                class="fa fa-eye fa-2x fa-fw"></i>
                        </button>
                        {% endif %}

                        {% if "11" in datos.permisos %}
                        <button type="button" class="btn btn-outline-primary" data-toggle="modal"
                            onclick="fichaRoles('{{ rol.idRol }}',true);return false;" title="Modificar"><i
                                class="fa fa-pencil fa-2x fa-fw"></i>
                        </button>
                        {% endif %}
                    </div>
                </td>
            </tr>
            {% else %}
            <h2 class="error">No hay Roles</h2>
            {% endfor %}
        </tbody>
    </table>
</div>
<script src="/public/js/ajaxFichaRoles.js"></script>
<script>
    var columnas = '0,1';
    var columNoOrdenar = 2;
    var titulo = 'Roles Registrados';
</script>
<script src="/public/js/ordypagtablas.js"></script>
{% endblock %}